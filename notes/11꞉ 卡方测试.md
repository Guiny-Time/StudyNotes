---
attachments: [Clipboard_2021-05-28-08-46-15.png, Clipboard_2021-05-28-08-47-57.png, Clipboard_2021-05-28-08-48-48.png, Clipboard_2021-05-30-21-53-28.png, Clipboard_2021-05-31-08-41-27.png]
tags: [ST221]
title: '11: 卡方测试'
created: '2021-05-28T00:35:48.496Z'
modified: '2021-05-31T00:41:28.137Z'
---

# 11: 卡方测试
## 卡方值图
或者说，有点歪的正态曲线(实际上完全不是正态曲线)
![](@attachment/Clipboard_2021-05-28-08-48-48.png)

## 临界卡方值
根据卡方值表，利用自由度df与重要性指数α获得值
值得注意的是，卡方值表中的横轴是右侧面积
![](@attachment/Clipboard_2021-05-28-08-47-57.png)

## 卡方拟合优度测试(chi-square Goodness-of-Fit Tests)
### 定义
指的是原假设认为数据属于均匀分布，而备择假设认为数据不属于均匀分布，现在需要是否能够推翻原假设
### 前提条件
- 计数数据条件(Counted Data Condition): 该数据必须是一个分类变量的类别计数。
- 独立性假设(Independence Assumption): 单位内的计数应该是相互独立的。
- 样本量假设(Frequency Condition): 我们必须有足够的数据才能使方法工作，所以我们通常检查期望单位频率条件。我们预计每个单位中至少有5个个体
### 计算卡方值
s是样本标准差，而σ是总体标准差
![](@attachment/Clipboard_2021-05-30-21-53-28.png)

## 卡方同一性测试(The χ2-test for homogeneity)
### 前提条件
- 计数数据条件: 该数据必须是一个分类变量的类别计数。
- 独立性假设:单位内的计数应该是相互独立的。
- 单位频率条件:我们必须有足够的数据才能使这些方法工作，所以我们通常检查期望单位频率条件。我们预计每个单位中至少有5个个体。
### 计算卡方值
![](@attachment/Clipboard_2021-05-28-08-46-15.png)
并不是所有时候都会直接把期望值列出来。拟合优度检测专注于寻找几种不同的分组(cell)的概率是否相同。我们需要利用求和之后的占比乘以该分组的总数才能获得期望值

计算完成之后，如果落于拒绝区间(计算卡方值比临界卡方值更大)，则拒绝原假设

## 卡方独立性测试(Chi-Square independence test)
原假设：独立
备择假设：不独立
这个卡方测试也是右尾测试
基本逻辑和前面一样的，值得注意的是自由度df = (r - 1)*(c - 1)

### 标准残差
计算公式：![](@attachment/Clipboard_2021-05-31-08-41-27.png)



