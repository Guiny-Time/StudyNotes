---
attachments: [Clipboard_2021-07-14-22-17-54.png, Clipboard_2021-07-14-23-39-02.png, Clipboard_2021-07-14-23-52-07.png, Clipboard_2021-07-14-23-55-22.png, Clipboard_2021-07-14-23-56-53.png, Clipboard_2021-07-14-23-58-01.png, Clipboard_2021-07-15-00-01-04.png, Clipboard_2021-07-15-00-02-39.png, Clipboard_2021-07-15-00-03-06.png, Clipboard_2021-07-15-00-04-37.png]
tags: [Unity Shader]
title: §1-3：MVP矩阵变换
created: '2021-07-14T13:17:56.003Z'
modified: '2021-07-15T09:30:35.257Z'
---

# §1-3：MVP矩阵变换

## 什么是MVP矩阵
MVP三个字母指的分别是模型(Model)、观察(View)、投影(Projection), 分别代表三个矩阵。

### MVP基本流程
一个物体在自己的模型空间(Local Space)有一个模型矩阵，转换到世界空间(World Space)之后有一个观察矩阵，再进入到摄像机所观察到的视觉空间(View Space)之后得到投影矩阵，组后进入裁剪空间(Clip Space)，经过投影映射获得屏幕空间视图(Screen Space)

### M(模型空间--->世界空间)
模型空间就是在建模的时候以模型自身中心为中心的坐标系
世界空间指的是以世界中心为中心的坐标系
变换方式(以下顺序不能改变)：
- 进行缩放
- 进行旋转
- 进行平移
![](@attachment/Clipboard_2021-07-14-22-17-54.png)
按照矩阵的规矩，乘法的顺序是从右往左的，所以最右边的矩阵是缩放矩阵(这里各方向均匀缩放了k倍)，中间的是旋转矩阵(转过θ角)，最左边的是平移矩阵(平移的t个单位)。
将模型坐标乘以M就能得到世界坐标。

### V(世界空间--->视觉空间)
视觉空间就是以摄像机的中心为中心的坐标系
变换步骤：
- 平移整个视觉空间，使摄像机原点和世界坐标原点重合、坐标轴重合
- 摄像机在世界空间中先旋转再平移
- 逆变换(为了让摄像机与世界坐标重合)
> **逆变换**
对矩阵进行平移、旋转以及z分量取反的操作(左手系的原因)

![](@attachment/Clipboard_2021-07-14-23-39-02.png)
可以看到，这里先平移了t个单位，然后旋转了θ角

### P(视觉空间--->裁剪空间)
这一步并不是真正的投影(三维的游戏物体投影到屏幕的二维坐标)，只是为投影做准备。裁剪空间的目的是判断顶点是否在可见范围内
变换步骤：
- 对x、y、z分量进行缩放，用w分量作为范围值
- 如果x、y、z分量都在w范围内，则该点位于裁剪空间内

#### 透视投影
透视投影常用于3D游戏，其特点是实现近大远小的效果。其P矩阵如下：
![](@attachment/Clipboard_2021-07-14-23-52-07.png)
这就是一个恒定的公式，推导过程挺复杂的(我相信我没有这个兴趣)
> 公式中的符号解析
>- **Near**
摄像机的近裁平面
>- **Far**
摄像机的远裁平面
>- **FOV**
摄像机的可视范围
![](@attachment/Clipboard_2021-07-14-23-55-22.png)
>- **近裁平面高度、远裁平面高度**
其实就是简单的数学计算
![](@attachment/Clipboard_2021-07-14-23-56-53.png)
>- **Ascept**
是一个比值，近裁平面宽比上近裁平面高或者远裁平面宽比上远裁平面高
![](@attachment/Clipboard_2021-07-14-23-58-01.png)

之后，当三个分量的范围都在w范围内则该点位于裁剪空间内
![](@attachment/Clipboard_2021-07-15-00-01-04.png)

#### 正交投影
正交投影常用于2D游戏，因为不论远近同一个物体看起来都是一样大的。其P矩阵如下：
![](@attachment/Clipboard_2021-07-15-00-04-37.png)

> 公式中的符号解析
>- **Near**
摄像机的近裁平面
>- **Far**
摄像机的远裁平面
>- **Size**
摄像机的可视范围
![](@attachment/Clipboard_2021-07-15-00-02-39.png)
>- **近裁平面高度、远裁平面高度**
其实就是简单的数学计算
![](@attachment/Clipboard_2021-07-15-00-03-06.png)
>- **Ascept**
是一个比值，近裁平面宽比上近裁平面高或者远裁平面宽比上远裁平面高
![](@attachment/Clipboard_2021-07-14-23-58-01.png)

之后，当三个分量的范围都在w范围内则该点位于裁剪空间内
![](@attachment/Clipboard_2021-07-15-00-01-04.png)






